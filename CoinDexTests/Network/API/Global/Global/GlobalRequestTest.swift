//
//  Copyright Â© 2022 CCT. All rights reserved.
//


import XCTest
@testable import CoinDexRelease


class GlobalRequestTest: XCTestCase {

    var request: GlobalGlobalRequest!
    var jsonData: Data!

    override func setUp() {
        super.setUp()
        
        self.request = GlobalGlobalRequest(baseURL: "http://www.test.com")
        
        // The Json to decode
        self.jsonData = """
        {
          "data": {
            "active_cryptocurrencies": 13473,
            "upcoming_icos": 0,
            "ongoing_icos": 49,
            "ended_icos": 3376,
            "markets": 521,
            "total_market_cap": {
              "btc": 46178885.203783825,
              "eth": 894427382.7850729,
              "ltc": 19389651701.414104,
              "bch": 7444010996.323498,
              "bnb": 4417439804.276596,
              "eos": 986603631567.0087,
              "xrp": 2839175447972.7275,
              "xlm": 8262368061891.78,
              "link": 149347172079.86807,
              "dot": 127246276003.15646,
              "yfi": 199310103.47913706,
              "usd": 866167153510.0469,
              "aed": 3181518571557.757,
              "ars": 106422364424259.72,
              "aud": 1249699905914.2212,
              "bdt": 80673575255899.27,
              "bhd": 326534622867.44574,
              "bmd": 866167153510.0469,
              "brl": 4463931012358.59,
              "cad": 1128360281713.3076,
              "chf": 840916648650.9211,
              "clp": 752577239433315.4,
              "cny": 5817784919980.951,
              "czk": 20402913767790.594,
              "dkk": 6139241204827.335,
              "eur": 825235558503.7748,
              "gbp": 708491817219.3876,
              "hkd": 6799329869174.28,
              "huf": 329994527562141.9,
              "idr": 12852924465862576,
              "ils": 2998683677959.0864,
              "inr": 67527777155088.91,
              "jpy": 116926069470205.02,
              "krw": 1118654878758224.5,
              "kwd": 265987806502.78632,
              "lkr": 311584838514175.5,
              "mmk": 1606958913821809,
              "mxn": 17616930426883.19,
              "myr": 3812867809751.231,
              "ngn": 360186796670199.2,
              "nok": 8661931385246.509,
              "nzd": 1371379067639.3132,
              "php": 46565146172700.125,
              "pkr": 181613262705530.66,
              "pln": 3861113320201.737,
              "rub": 49804526442446.63,
              "sar": 3249297883654.2217,
              "sek": 8817581622732.277,
              "sgd": 1204492043671.0715,
              "thb": 30520037152951.527,
              "try": 15009290902883.523,
              "twd": 25739456217281.344,
              "uah": 25641732640520.863,
              "vef": 86729317080.96126,
              "vnd": 20120031137093424,
              "zar": 13883065723203.623,
              "xdr": 634670989227.1865,
              "xag": 39953293853.06733,
              "xau": 470675231.21735996,
              "bits": 46178885203783.83,
              "sats": 4617888520378383
            },
            "total_volume": {
              "btc": 4480743.465556925,
              "eth": 86786409.70096466,
              "ltc": 1881380522.226577,
              "bch": 722293391.928339,
              "bnb": 428624780.57139367,
              "eos": 95730283564.2377,
              "xrp": 275485577010.6608,
              "xlm": 801698688480.127,
              "link": 14491176269.050394,
              "dot": 12346723339.065762,
              "yfi": 19339086.247808386,
              "usd": 84044315839.22636,
              "aed": 308703176509.0627,
              "ars": 10326176387299.342,
              "aud": 121258550582.62494,
              "bdt": 7827767898159.798,
              "bhd": 31683698539.598286,
              "bmd": 84044315839.22636,
              "brl": 433135828767.9875,
              "cad": 109484950465.33957,
              "chf": 81594255943.88115,
              "clp": 73022671141515.39,
              "cny": 564500456197.3335,
              "czk": 1979697477319.316,
              "dkk": 595691402913.1632,
              "eur": 80072717649.92775,
              "gbp": 68745056672.48552,
              "hkd": 659739895127.9218,
              "huf": 32019413559218.098,
              "idr": 1247120996090905.8,
              "ils": 290962682100.1394,
              "inr": 6552229333731.434,
              "jpy": 11345352305926.766,
              "krw": 108543233906360.73,
              "kwd": 25808832773.804672,
              "lkr": 30233118945552.3,
              "mmk": 155923440350516.25,
              "mxn": 1709373137638.235,
              "myr": 369963078324.2749,
              "ngn": 34948973506784.332,
              "nok": 840468371687.014,
              "nzd": 133065096071.71951,
              "php": 4518222419516.81,
              "pkr": 17621959398439.555,
              "pln": 374644346716.5194,
              "rub": 4832539924412.562,
              "sar": 315279812312.1135,
              "sek": 855571135243.3243,
              "sgd": 116872025606.0282,
              "thb": 2961363325211.6025,
              "try": 1456353522588.4526,
              "twd": 2497502911636.3735,
              "uah": 2488020779790.443,
              "vef": 8415357344.981761,
              "vnd": 1952249337473098.5,
              "zar": 1347075741361.6572,
              "xdr": 61582211766.45575,
              "xag": 3876673496.3307095,
              "xau": 45669681.22703565,
              "bits": 4480743465556.925,
              "sats": 448074346555692.5
            },
            "market_cap_percentage": {
              "btc": 41.29759286271677,
              "eth": 13.595575495652165,
              "usdt": 7.8974146037567365,
              "usdc": 6.430758622933186,
              "bnb": 3.7073626223158374,
              "busd": 2.021882783926467,
              "ada": 1.774913128515211,
              "xrp": 1.7016566164534155,
              "sol": 1.1744873841587053,
              "dot": 0.8813826517524233
            },
            "market_cap_change_percentage_24h_usd": -7.342411028686204,
            "updated_at": 1655575215
          }
        }
        """.data(using: .utf8)!
        
    }

    override func tearDown() {
        self.request = nil
        self.jsonData = nil
        
        super.tearDown()
        
    }
    
    func testGlobalRequestTest_01() {
        XCTAssertTrue(self.request.url == "http://www.test.com/global")
        XCTAssertTrue(self.request.headers == [.accept: .applicationJson])
        XCTAssertTrue(self.request.method == .get)
    }
    
    func testGlobalRequestTest_02() {
        do {
            let dates = try? self.request.decode(self.jsonData)
            XCTAssertNotNil(dates)
        }
    }
}
